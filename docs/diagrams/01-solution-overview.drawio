<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-12-19T18:00:00.000Z" agent="5.0" etag="example" version="24.0.0">
  <diagram name="Solution Overview" id="solution-overview">
    <mxGraphModel dx="1422" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Background -->
        <mxCell id="background" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#1B3B4D;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="0" y="0" width="1169" height="827" as="geometry" />
        </mxCell>
        
        <!-- Title -->
        <mxCell id="title" value="Azure Communication Services Email MCP Tool - Solution Overview" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=18;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="284" y="30" width="600" height="30" as="geometry" />
        </mxCell>
        
        <!-- Developer/Client Side -->
        <mxCell id="client-section" value="Developer Environment" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#3A5F73;strokeColor=#40E0D0;strokeWidth=2;fontStyle=1;fontSize=14;fontColor=#40E0D0;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="50" y="100" width="300" height="200" as="geometry" />
        </mxCell>
        
        <!-- VS Code with MCP -->
        <mxCell id="vscode" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/other/Visual_Studio_Code.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="80" y="130" width="50" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="vscode-label" value="VS Code with&#xa;MCP Extension" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="60" y="185" width="90" height="30" as="geometry" />
        </mxCell>
        
        <!-- Claude/Copilot -->
        <mxCell id="ai-agent" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/ai_machine_learning/Cognitive_Services.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="200" y="130" width="50" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="ai-label" value="AI Agent&#xa;(Claude/Copilot)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="180" y="185" width="90" height="30" as="geometry" />
        </mxCell>
        
        <!-- MCP Connection -->
        <mxCell id="mcp-connection" value="MCP Protocol&#xa;(JSON-RPC)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#40E0D0;strokeWidth=2;fontSize=10;fontColor=#40E0D0;" edge="1" parent="1" source="vscode" target="ai-agent">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Azure Cloud Section -->
        <mxCell id="azure-section" value="Microsoft Azure" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2D4A5A;strokeColor=#00B7C3;strokeWidth=2;fontStyle=1;fontSize=14;fontColor=#00B7C3;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="400" y="100" width="700" height="600" as="geometry" />
        </mxCell>
        
        <!-- Connection Options Section -->
        <mxCell id="connection-note" value="Two Connection Methods Available" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="50" y="320" width="300" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="direct-method" value="1. Direct Function App (Function Key)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#00B7C3;" vertex="1" parent="1">
          <mxGeometry x="60" y="350" width="280" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="apim-method" value="2. Via APIM (OAuth2/Entra ID)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#8B5FBF;" vertex="1" parent="1">
          <mxGeometry x="60" y="370" width="280" height="15" as="geometry" />
        </mxCell>
        
        <!-- Azure Functions -->
        <mxCell id="functions" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/compute/Function_Apps.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="450" y="150" width="68" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="functions-label" value="Azure Functions&#xa;(Flex Consumption)&#xa;MCP Server Host" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="430" y="215" width="108" height="45" as="geometry" />
        </mxCell>
        
        <!-- API Management -->
        <mxCell id="apim" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/app_services/API_Management_Services.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="450" y="300" width="68" height="62" as="geometry" />
        </mxCell>
        
        <mxCell id="apim-label" value="API Management&#xa;Authentication &amp;&#xa;Authorization" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="430" y="365" width="108" height="45" as="geometry" />
        </mxCell>
        
        <!-- Communication Services -->
        <mxCell id="acs" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/other/Azure_Communication_Services.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="600" y="150" width="68" height="68" as="geometry" />
        </mxCell>
        
        <mxCell id="acs-label" value="Azure Communication&#xa;Services" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="590" y="225" width="88" height="30" as="geometry" />
        </mxCell>
        
        <!-- Email Services -->
        <mxCell id="email-service" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/other/Email_Communication_Services.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="750" y="150" width="68" height="68" as="geometry" />
        </mxCell>
        
        <mxCell id="email-label" value="Email Communication&#xa;Services" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="740" y="225" width="88" height="30" as="geometry" />
        </mxCell>
        
        <!-- Managed Identity -->
        <mxCell id="managed-identity" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/identity/Managed_Identities.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="600" y="300" width="68" height="68" as="geometry" />
        </mxCell>
        
        <mxCell id="identity-label" value="Managed Identity&#xa;(Authentication)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="590" y="375" width="88" height="30" as="geometry" />
        </mxCell>
        
        <!-- Storage Account -->
        <mxCell id="storage" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/storage/Storage_Accounts.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="450" y="450" width="68" height="54" as="geometry" />
        </mxCell>
        
        <mxCell id="storage-label" value="Storage Account&#xa;(Function App Data)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="430" y="510" width="108" height="30" as="geometry" />
        </mxCell>
        
        <!-- Entra ID -->
        <mxCell id="entra-id" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/identity/Azure_Active_Directory.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="750" y="300" width="68" height="62" as="geometry" />
        </mxCell>
        
        <mxCell id="entra-label" value="Microsoft Entra ID&#xa;Identity Provider" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="740" y="365" width="88" height="30" as="geometry" />
        </mxCell>
        
        <!-- Email Output -->
        <mxCell id="email-output" value="" style="image;aspect=fixed;perimeter=ellipsePerimeter;html=1;align=center;shadow=0;dashed=0;spacingTop=3;image=img/lib/azure2/other/Email.svg;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="900" y="150" width="68" height="68" as="geometry" />
        </mxCell>
        
        <mxCell id="email-output-label" value="Email&#xa;Delivery" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="900" y="225" width="68" height="30" as="geometry" />
        </mxCell>
        
        <!-- Connection Lines -->
        <!-- Direct Connection (Blue) -->
        <mxCell id="direct-to-function" value="Direct HTTPS&#xa;(Function Key)" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#00B7C3;strokeWidth=3;fontSize=9;fontColor=#00B7C3;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="client-section" target="functions">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="350" y="180" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- APIM Connection (Purple) -->
        <mxCell id="apim-to-client" value="OAuth2/PKCE&#xa;via APIM" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8B5FBF;strokeWidth=2;fontSize=9;fontColor=#8B5FBF;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.8;exitDx=0;exitDy=0;" edge="1" parent="1" source="client-section" target="apim">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="350" y="280" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        
        <!-- APIM to Function -->
        <mxCell id="apim-to-function" value="Authenticated&#xa;Request" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8B5FBF;strokeWidth=2;fontSize=9;fontColor=#8B5FBF;" edge="1" parent="1" source="apim" target="functions">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- APIM to Entra ID -->
        <mxCell id="apim-to-entra" value="OAuth2&#xa;Validation" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#9C4F96;strokeWidth=2;fontSize=9;fontColor=#9C4F96;" edge="1" parent="1" source="apim" target="entra-id">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Function to Identity -->
        <mxCell id="function-to-identity" value="Uses" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#32CD32;strokeWidth=2;fontSize=9;fontColor=#32CD32;" edge="1" parent="1" source="functions" target="managed-identity">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Function to Storage -->
        <mxCell id="function-to-storage" value="Data" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#FF9800;strokeWidth=2;fontSize=9;fontColor=#FF9800;" edge="1" parent="1" source="functions" target="storage">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Identity to ACS -->
        <mxCell id="identity-to-acs" value="Authenticates" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#32CD32;strokeWidth=2;fontSize=9;fontColor=#32CD32;" edge="1" parent="1" source="managed-identity" target="acs">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- ACS to Email Services -->
        <mxCell id="acs-to-email" value="Email API" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#40E0D0;strokeWidth=2;fontSize=9;fontColor=#40E0D0;" edge="1" parent="1" source="acs" target="email-service">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Email Service to Output -->
        <mxCell id="email-to-output" value="SMTP" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#32CD32;strokeWidth=2;fontSize=9;fontColor=#32CD32;" edge="1" parent="1" source="email-service" target="email-output">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Features Section -->
        <mxCell id="features-section" value="Key Features" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#3A5F73;strokeColor=#40E0D0;strokeWidth=2;fontStyle=1;fontSize=14;fontColor=#40E0D0;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="50" y="420" width="300" height="250" as="geometry" />
        </mxCell>
        
        <mxCell id="feature1" value="✓ Send Rich HTML Emails" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="450" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature2" value="✓ Incident Email Templates" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="475" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature3" value="✓ File Attachments Support" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="500" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature4" value="✓ Managed Identity Security" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="525" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature5" value="✓ OAuth2/APIM Integration" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="550" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature6" value="✓ Azure-Managed Domains" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="575" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature7" value="✓ Flex Consumption Pricing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="600" width="200" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="feature8" value="✓ Enterprise-Grade Security" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="70" y="625" width="200" height="20" as="geometry" />
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2D4A5A;strokeColor=#FFFFFF;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="320" width="180" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-title" value="Connection Types" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;fontColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="920" y="330" width="140" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-direct" value="Direct Connection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#00B7C3;" vertex="1" parent="1">
          <mxGeometry x="920" y="360" width="120" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-oauth" value="OAuth2/APIM" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#8B5FBF;" vertex="1" parent="1">
          <mxGeometry x="920" y="380" width="120" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-managed" value="Managed Identity" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#32CD32;" vertex="1" parent="1">
          <mxGeometry x="920" y="400" width="120" height="15" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-mcp" value="MCP Protocol" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#40E0D0;" vertex="1" parent="1">
          <mxGeometry x="920" y="420" width="120" height="15" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
